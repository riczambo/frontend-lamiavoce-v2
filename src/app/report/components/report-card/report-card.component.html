<div class="report-single-card">
    <div class="menu-container">
    <button
        tuiIconButton
        tuiDropdownHover
        appearance="flat"
        iconStart="@tui.ellipsis"
        type="button"
        size="s"
        tuiDropdownAlign="right"
        [tuiDropdown]="dropdown"
        class="menu-button"
        (tuiDropdownOpenChange)="toggleDropdown($event)">
    </button>
    <ng-template #dropdown let-close>
        <tui-data-list class="report-dropdown">
        <button tuiOption type="button" iconStart="@tui.flag" (click)="flagContent(report)">
            Segnala
        </button>
        <button *ngIf="user?.email === 'rovigosegnala@gmail.com'" tuiOption type="button" iconStart="@tui.trash" (click)="onDelete()">
            Cancella
        </button>
        </tui-data-list>
    </ng-template>
    </div>  

    <span tuiTitle class="fade report-title">{{ report.title }}</span>
    <section class="report-description">
        <ng-container *ngIf="!needsTruncate(report.description) || isExpanded(report.id)">
        {{ report.description }}
        </ng-container>
        <ng-container *ngIf="needsTruncate(report.description) && !isExpanded(report.id)">
        {{ report.description | slice:0:200 }}
        <span class="continue" (click)="toggleExpanded(report.id)"> Continua...</span>
        </ng-container>
    </section>
    <p><strong>Categoria:</strong> {{ report.category }}</p>
    <p><strong>Zona:</strong> {{ report.zone }}</p>
</div>

<div class="card-extension">
    <button
        tuiButton
        [iconStart]="report.upvotes.includes(user?.uid ?? '') ? '@tui.arrow-big-up-filled' : '@tui.arrow-big-up'"
        size="m"
        class="arrow-up-button"
        (click)="onUpvote()">
        {{ report.upvotes.length || 0}}
    </button>
</div>  